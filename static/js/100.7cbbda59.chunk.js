(this["webpackJsonpgull-react"]=this["webpackJsonpgull-react"]||[]).push([[100],{2498:function(e,t,a){"use strict";a.r(t);var n=a(14),r=a(25),i=a(222),s=a(20),o=a(21),c=a(0),l=a.n(c),u=a(17),p=a.n(u),d=a(36),m=a(91),y=[{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{payable:!1,stateMutability:"nonpayable",type:"fallback"},{constant:!0,inputs:[],name:"alfredDao",outputs:[{internalType:"address",name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"",type:"address"}],name:"balances",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"mcdContract",outputs:[{internalType:"address",name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"rDaiContract",outputs:[{internalType:"address",name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"redeem",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!0,stateMutability:"payable",type:"function"},{constant:!1,inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"stake",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!0,stateMutability:"payable",type:"function"}],b="0xf871EFEFB58aE7C72f646416B91115F379eFd5f5",f=new m.ethers.providers.Web3Provider(window.web3.currentProvider);console.log("provider",f);var g=f.getSigner(),h=new m.Contract(b,y,g);console.log("contract",h);var v=window.ethereum.selectedAddress;function w(){return x.apply(this,arguments)}function x(){return(x=Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.balances(v);case 2:return t=e.sent,console.log("tx:",t.toString()),e.abrupt("return",(Number(t.toString())/Math.pow(10,18)).toFixed(4));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=a(15),E=a.n(k),T="https://api.compound.finance/api/v2/ctoken?network=".concat("mainnet");function N(){return(N=Object(d.a)(p.a.mark((function e(){var t,a,n,r,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.ethereum.selectedAddress,a=null,n=null,e.next=5,w(t);case 5:return r=e.sent,i=function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.a.get(T).then((function(e){return console.log("Response from the server: ",e),a=(a=(a=e.data.cToken).filter((function(e){return"cDAI"===e.symbol})))[0].supply_rate.value,console.log("stake * rate:",r*a),n=a*r,console.log("streamingAmt",n),n})).catch((function(e){console.log(e)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=9,i();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=a(1159),M=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{constant:!0,inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}];function D(){return(D=Object(d.a)(p.a.mark((function e(t){var a,n,r,i,s,o,c,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("contract:",h),a=(a=t*Math.pow(10,18)).toString(),console.log("dai:",a),n="0x4F96Fe3b7A6Cf9725f59d353F723c1bDb64CA6Aa",r=new m.ethers.providers.Web3Provider(window.web3.currentProvider),console.log("provider",r),i=r.getSigner(),e.next=10,i.getAddress();case 10:return s=e.sent,o=new m.Contract(n,M,i),e.next=14,o.allowance(s,b);case 14:if(!e.sent.lt(m.ethers.utils.bigNumberify(a))){e.next=21;break}return e.next=18,o.approve(b,m.ethers.constants.MaxUint256);case 18:return c=e.sent,e.next=21,c.wait();case 21:return e.next=23,h.stake(a,{gasLimit:1e6});case 23:return l=e.sent,console.log("tx:",l.toString()),e.prev=25,e.next=28,l.wait();case 28:S.NotificationManager.success("Your approval transaction was successful. You will be prompted to complete one more transaction to finish the deposit","Success"),e.next=35;break;case 31:return e.prev=31,e.t0=e.catch(25),S.NotificationManager.warning("There was a problem with your transaction","Error"),e.abrupt("return",!1);case 35:return S.NotificationManager.success("Your Dai has been staked with rDAI and is now generating donations from the interest","Success"),setTimeout((function(){window.location.reload()}),2e3),e.abrupt("return",!0);case 38:case"end":return e.stop()}}),e,null,[[25,31]])})))).apply(this,arguments)}function C(){return O.apply(this,arguments)}function O(){return(O=Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("contract:",h),e.next=3,h.redeem({gasLimit:1e6});case 3:return t=e.sent,console.log("tx:",t.toString()),e.prev=5,e.next=8,t.wait();case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(5),S.NotificationManager.warning("There was a problem with your transaction","Error"),e.abrupt("return",!1);case 14:return S.NotificationManager.success("Your Dai has been redeemed from rDAI and is no longer generating interest","Success"),setTimeout((function(){window.location.reload()}),2e3),e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e,null,[[5,10]])})))).apply(this,arguments)}var j=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={dai:0},r.handleChange=r.handleChange.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"handleChange",value:function(e){this.setState({dai:e.target.value})}},{key:"render",value:function(){var e=this;return l.a.createElement(c.Fragment,null,l.a.createElement("div",null,l.a.createElement("div",{className:"col-lg-6 col-md-6 col-sm-6",style:{display:"flex",XXheight:"76px"}},l.a.createElement("div",{className:"card o-hidden",style:{display:"flex",flexDirection:"column"}},l.a.createElement("div",{className:"card-body"},l.a.createElement("label",null,"How much Dai would you like to stake?",l.a.createElement("input",{className:"form-control",onChange:this.handleChange})),l.a.createElement("div",null,l.a.createElement("button",{className:"d-block w-100 my-2 text-capitalize btn btn-primary",XXclassName:"XXXcard-body d-block text-center",style:{padding:"4px"},onClick:function(t){return function(e){return D.apply(this,arguments)}(e.state.dai)}},"Stake it!")),l.a.createElement("div",null,l.a.createElement("button",{className:"d-block w-100 my-2 text-capitalize btn btn-primary",XXclassName:"XXXcard-body d-block text-center",style:{padding:"4px"},onClick:function(e){return C()}},"Un-stake it!")))))))}}]),a}(c.Component),F=a(207),A=a(253),X=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).getStake=function(){w().then((function(e){return r.setState({stake:e})})).catch((function(e){return console.log("err:",e)}))},r.getStreaming=function(){(function(){return N.apply(this,arguments)})().then((function(e){return r.setState({rate:e.toFixed(2)+"/yr"})})).catch((function(e){return console.log("err:",e)}))},r.redeem=function(){C()},r.state={stakeDai:[{leftIcon:"i-Money-2",leftTitle:"120.00",leftSubtitle:"staked",rightIcon:"i-Financial",rightTitle:"4.0210",rightSubtitle:"Streaming"}],stake:0,rate:0,modal:!1},r.getStake=r.getStake.bind(Object(i.a)(r)),r.getStreaming=r.getStreaming.bind(Object(i.a)(r)),r.redeem=r.redeem.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.getStake(),this.getStreaming(),console.log("state:",this.state)}},{key:"render",value:function(){var e=this,t=this.state.stakeDai,a=void 0===t?[]:t;return l.a.createElement(A.a,null,l.a.createElement(c.Fragment,null,l.a.createElement(S.NotificationContainer,null),l.a.createElement(F.a,{title:"Stake with rDAI and Donate Interest"},l.a.createElement("div",{className:"mb-4"},"Put your money to work passively. Stake Dai through rDai to help fund Alfred.Estate's DeFi development efforts:"),l.a.createElement("div",null,a.map((function(t,a){return l.a.createElement(c.Fragment,null,l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"cursor-pointer col-lg-3 col-md-6 col-sm-6",onClick:function(t){return e.setState({modal:!e.state.modal})}},l.a.createElement("div",{className:"card card-icon-bg card-icon-bg-primary o-hidden mb-4"},l.a.createElement("div",{className:"card-body text-center"},l.a.createElement("i",{className:t.leftIcon}),l.a.createElement("div",{className:"content"},l.a.createElement("p",{className:"text-muted mt-2 mb-0 text-capitalize"},t.leftSubtitle),l.a.createElement("p",{className:"lead text-primary text-24 mb-2 text-capitalize"},e.state.stake&&e.state.stake,"\xa0Dai"))))),l.a.createElement("div",{className:"col-lg-3 col-md-6 col-sm-6"},l.a.createElement("div",{className:"card card-icon-bg card-icon-bg-primary o-hidden mb-4"},l.a.createElement("div",{className:"card-body text-center"},l.a.createElement("i",{className:t.rightIcon}),l.a.createElement("div",{className:"content"},l.a.createElement("p",{className:"text-muted mt-2 mb-0 text-capitalize"},t.rightSubtitle),l.a.createElement("p",{className:"lead text-primary text-24 mb-2 text-capitalize"},e.state.rate&&e.state.rate)))))))})))),this.state.modal&&l.a.createElement(j,null)))}}]),a}(c.Component);t.default=X}}]);
//# sourceMappingURL=100.7cbbda59.chunk.js.map